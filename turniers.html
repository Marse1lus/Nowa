{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤</title>
    <link rel="stylesheet" href="{% static 'tournaments/styles.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤—Ö–æ–¥–∞ -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–í—Ö–æ–¥</h2>
            <form id="loginForm">
                <input type="email" placeholder="Email" required>
                <input type="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <form id="registerForm">
                <input type="text" placeholder="–ò–º—è" required>
                <input type="email" placeholder="Email" required>
                <input type="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <input type="password" placeholder="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" required>
                <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
        </div>
    </div>

    <header class="header" role="banner">
        <div class="logo" role="heading" aria-level="1">
            <a href="{% url 'home' %}" class="logo-link">
                NO<span class="highlight-w">W</span>ACHAMPIONSHIP ü§º‚Äç‚ôÇÔ∏è
            </a>
        </div>
        <nav class="nav-menu" role="navigation" aria-label="–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é">
            <a href="{% url 'tournament_list' %}" role="menuitem">–¢—É—Ä–Ω–∏—Ä—ã</a>
            
            <div class="dropdown">
                <a href="#" 
                   class="nav-link" 
                   role="button" 
                   aria-haspopup="true" 
                   aria-expanded="false"
                   aria-controls="sections-menu">
                    –°–µ–∫—Ü–∏–∏ ‚ñº
                </a>
                <div class="dropdown-content" 
                     id="sections-menu" 
                     role="menu" 
                     aria-label="–í—ã–±–æ—Ä —Å–µ–∫—Ü–∏–∏">
                    <a href="#" role="menuitem">–ú–∞–º–µ—Ç–æ–≤–∞</a>
                    <a href="#" role="menuitem">–ñ–∞–Ω—Å—É–≥—É—Ä–æ–≤–∞</a>
                </div>
            </div>
            
            <div class="dropdown">
                <a href="#" 
                   class="nav-link" 
                   role="button" 
                   aria-haspopup="true" 
                   aria-expanded="false"
                   aria-controls="about-menu">
                    –û –Ω–∞—Å ‚ñº
                </a>
                <div class="dropdown-content" 
                     id="about-menu" 
                     role="menu" 
                     aria-label="–û –Ω–∞—Å">
                    <a href="https://teamnova.kz/p/d9b54a/" role="menuitem"> –û–¥–µ–∂–¥–∞</a>        
                    <a href="#" role="menuitem">–ì–∞–ª–µ—Ä–µ—è</a>
                    <a href="https://teamnova.kz/?fbclid=PAZXh0bgNhZW0CMTEAAabqvuAdlphCRMiUAHZdep2UTLlLhtCTS6DYdvksrVo9BqU0Xt3qHUsoojE_aem_M8j27ck8Z9D-t-2EcmU9aQ#contacts" role="menuitem" target="_blank">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
                </div>
            </div>

            <a href="#" class="signup" role="button">–í–æ–π—Ç–∏</a>
            <a href="#" class="signup" role="button">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</a>
        </nav>
    </header>

    <main>
        <div class="filters">
            <button class="filter-btn">–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ —Ç—É—Ä–Ω–∏—Ä—ã</button>
            <button class="filter-btn">–¢–µ–∫—É—â–∏–µ —Ç—É—Ä–Ω–∏—Ä—ã</button>
            <button class="filter-btn">–í–∞—à–∏ —Ç—É—Ä–Ω–∏—Ä—ã</button>
        </div>

        <div class="button-container">
            <button class="nav-btn" onclick="window.location.href='/create-tournament'">–°–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä</button>
            <button class="nav-btn" onclick="window.location.href='/nearest-section'">–ë–ª–∏–∂–∞–π—à–∞—è —Å–µ–∫—Ü–∏—è</button>
            <button class="nav-btn" onclick="window.location.href='/map'">–ö–∞—Ä—Ç–∞</button>
        </div>

        <div class="search-container">
            <input type="text" class="search-input" placeholder="–ù–∞–π—Ç–∏ —Ç—É—Ä–Ω–∏—Ä">
            <select class="search-input">
                <option value="">–¢–∏–ø —Ç—É—Ä–Ω–∏—Ä–∞</option>
                <option value="greco">–ì—Ä–µ–∫–æ-—Ä–∏–º—Å–∫–∞—è –±–æ—Ä—å–±–∞</option>
                <option value="freestyle">–í–æ–ª—å–Ω–∞—è –±–æ—Ä—å–±–∞</option>
                <option value="judo">–î–∑—é–¥–æ</option>
                <option value="bjj">BJJ</option>
            </select>
        </div>

        <div class="date-container">
            <input type="date" class="date-input" placeholder="–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞">
            <input type="date" class="date-input" placeholder="–ö–æ–Ω–µ—Ü –¥–∞—Ç—ã">
            <button class="search-btn">–ü–æ–∏—Å–∫</button>
        </div>

        <div class="tournaments-container">
            <h1>–î–æ–±–∞–≤–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä</h1>
            <form method="post" action="{% url 'tournament_list' %}" class="tournament-form">
                {% csrf_token %}
                {{ form.as_p }}
                <button type="submit" class="form-control">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>

            <h2>–°–ø–∏—Å–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤</h2>
            <div class="tournaments-grid">
                {% for tournament in tournaments %}
                <div class="tournament-card">
                    <h2>{{ tournament.name }}</h2>
                    <div class="tournament-dates">
                        <span>–î–∞—Ç–∞: {{ tournament.date|date:"d.m.Y" }}</span>
                    </div>
                    <div class="tournament-location">{{ tournament.location }}</div>
                </div>
                {% empty %}
                <div class="no-tournaments">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤.</div>
                {% endfor %}
            </div>
        </div>
    </main>

    <footer>
        <!-- –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∞–π—Ç–µ –∏–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loginBtn = document.querySelectorAll('.signup')[0];
            const registerBtn = document.querySelectorAll('.signup')[1];
            const loginModal = document.getElementById('loginModal');
            const registerModal = document.getElementById('registerModal');
            const closeButtons = document.getElementsByClassName('close');
            const navLinks = document.querySelectorAll('.nav-link');

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            function openModal(modal) {
                modal.style.display = "block";
                modal.style.opacity = "1";
                modal.setAttribute('aria-hidden', 'false');
                modal.querySelector('input').focus();
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            function closeModal(modal) {
                modal.style.opacity = "0";
                setTimeout(() => {
                    modal.style.display = "none";
                    modal.setAttribute('aria-hidden', 'true');
                }, 300);
            }

            // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            loginBtn.onclick = function(e) {
                e.preventDefault();
                openModal(loginModal);
            }

            registerBtn.onclick = function(e) {
                e.preventDefault();
                openModal(registerModal);
            }

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            Array.from(closeButtons).forEach(button => {
                button.onclick = function() {
                    closeModal(loginModal);
                    closeModal(registerModal);
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            window.onclick = function(event) {
                if (event.target == loginModal) {
                    closeModal(loginModal);
                }
                if (event.target == registerModal) {
                    closeModal(registerModal);
                }
            }

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∞–≤–∏—à–µ Esc
            window.onkeydown = function(event) {
                if (event.key === 'Escape') {
                    closeModal(loginModal);
                    closeModal(registerModal);
                }
            }

            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const expanded = this.getAttribute('aria-expanded') === 'true';
                    this.setAttribute('aria-expanded', !expanded);
                    const menu = document.getElementById(this.getAttribute('aria-controls'));
                    menu.style.display = expanded ? 'none' : 'block';
                });
            });
        });

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º
        document.getElementById('loginForm').onsubmit = function(e) {
            e.preventDefault();
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –≤—Ö–æ–¥–∞
            console.log('–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ö–æ–¥');
        }

        document.getElementById('registerForm').onsubmit = function(e) {
            e.preventDefault();
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            console.log('–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è');
        }

        const dateInputs = document.querySelectorAll('.date-input');

        dateInputs.forEach(input => {
            const placeholder = input.getAttribute('placeholder');

            input.addEventListener('focus', function() {
                if (this.value === '') {
                    this.setAttribute('data-placeholder', placeholder);
                    this.removeAttribute('placeholder');
                }
            });

            input.addEventListener('blur', function() {
                if (this.value === '') {
                    this.setAttribute('placeholder', this.getAttribute('data-placeholder'));
                }
            });

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            if (input.value === '') {
                input.setAttribute('placeholder', placeholder);
            }
        });
    </script>
</body>
</html> 
